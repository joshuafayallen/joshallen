{
  "hash": "c13ebc0265f5e4dfa5ee62cbb99b3732",
  "result": {
    "markdown": "---\ntitle: \"Translating What I know in the tidyverse to polars:\"\nsubtitle: \"wrangling data with polars \"\ndate: last-modified\ndate-format: \"MMM D, YYYY\"\ndescription: \"This is me learning the snake language\"\ncategories:\n  - r\n  - tidyverse\n  - python\n  - polars\n---\n\n\n\nI suppose at some point it is good to become more well versed in lots of tools. I have been python curious for about a year or so and I think it is important to use the tool best suited for the task. Also sometimes it is important to get out of your comfort zone. I am definitely somebody who is very comfortable in R and the `tidyverse` and use it for a lot of stuff. I have heard lots of ravings about polars specifically about its speed and similarities in intuition with the tidyverse. So I thought I would have a collection of code for myself and the people of the internet to reference. \n\n\nJust a disclaimer. This is really just me working through the similarities and is going to be based on the [tidyintelligence's blog post](https://blog.tidy-intelligence.com/posts/dplyr-vs-polars/), [Robert Mitchell's blog post](https://robertmitchellv.com/blog/2022-07-r-python-side-by-side/r-python-side-by-side.html), and [Emily Rieder's blog post](https://www.emilyriederer.com/post/py-rgo-polars/). In all honesty, this is just for me to smash them together to have a one-stop shop for myself. If you found this post over these resources I highly recommend you check out these resources. \n\n\n\n# The Basics \n\nAs always we should load in the respective packages we are going to use. \n\n\n\n\n\n\n\n:::{.panel-tabset}\n## R \n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressPackageStartupMessages(library(tidyverse))\nlibrary(palmerpenguins)\n```\n:::\n\n\n\n## Python \n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport polars as pl\nimport polars.selectors as cs\nfrom palmerpenguins import load_penguins\n\n\npenguins = load_penguins().pipe(pl.from_pandas)\n\npl.Config(tbl_rows = 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<polars.config.Config object at 0x29e22fc80>\n```\n:::\n:::\n\n\n\n\n:::\n\n\nOkay so far nothing too crazy! The main difference in loading in the packages and the data we are using is really just that to get with our familiar `starts_with` friends from the tidyverse we have to add `polars.selectors` and change some defaults. Lots of the time we would like to see the top and bottom portion and the column types. In `R` this is just our `head`, `tail`, `glimpse/str` in python it should be broadly similar. \n\n\n:::{.panel-tabset}\n\n## R \n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(penguins) |>\nknitr::kable(booktabs = TRUE)\n```\n\n::: {.cell-output-display}\n|species |island    | bill_length_mm| bill_depth_mm| flipper_length_mm| body_mass_g|sex    | year|\n|:-------|:---------|--------------:|-------------:|-----------------:|-----------:|:------|----:|\n|Adelie  |Torgersen |           39.1|          18.7|               181|        3750|male   | 2007|\n|Adelie  |Torgersen |           39.5|          17.4|               186|        3800|female | 2007|\n|Adelie  |Torgersen |           40.3|          18.0|               195|        3250|female | 2007|\n|Adelie  |Torgersen |             NA|            NA|                NA|          NA|NA     | 2007|\n|Adelie  |Torgersen |           36.7|          19.3|               193|        3450|female | 2007|\n|Adelie  |Torgersen |           39.3|          20.6|               190|        3650|male   | 2007|\n:::\n:::\n\n\n\n## Python\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.head()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 8)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>species</th><th>island</th><th>bill_length_mm</th><th>bill_depth_mm</th><th>flipper_length_mm</th><th>body_mass_g</th><th>sex</th><th>year</th></tr><tr><td>str</td><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>str</td><td>i64</td></tr></thead><tbody><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td><td>39.1</td><td>18.7</td><td>181.0</td><td>3750.0</td><td>&quot;male&quot;</td><td>2007</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td><td>39.5</td><td>17.4</td><td>186.0</td><td>3800.0</td><td>&quot;female&quot;</td><td>2007</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td><td>40.3</td><td>18.0</td><td>195.0</td><td>3250.0</td><td>&quot;female&quot;</td><td>2007</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td><td>null</td><td>null</td><td>null</td><td>null</td><td>null</td><td>2007</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td><td>36.7</td><td>19.3</td><td>193.0</td><td>3450.0</td><td>&quot;female&quot;</td><td>2007</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n:::\n\nSo one big difference for me is that when you are doing things with objects instead of feeding them directly to head you are doing `object_name.head()` which I suppose will take some time to get used to. I suppose for completeness we should look at the glimpse equivalent since I use that function all the time \n\n\n:::{.panel-tabset}\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(penguins)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 344\nColumns: 8\n$ species           <fct> Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel…\n$ island            <fct> Torgersen, Torgersen, Torgersen, Torgersen, Torgerse…\n$ bill_length_mm    <dbl> 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, …\n$ bill_depth_mm     <dbl> 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, …\n$ flipper_length_mm <int> 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186…\n$ body_mass_g       <int> 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, …\n$ sex               <fct> male, female, female, NA, female, male, female, male…\n$ year              <int> 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007…\n```\n:::\n:::\n\n\n## Python\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 344\nColumns: 8\n$ species           <str> 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie'\n$ island            <str> 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen'\n$ bill_length_mm    <f64> 39.1, 39.5, 40.3, None, 36.7, 39.3, 38.9, 39.2, 34.1, 42.0\n$ bill_depth_mm     <f64> 18.7, 17.4, 18.0, None, 19.3, 20.6, 17.8, 19.6, 18.1, 20.2\n$ flipper_length_mm <f64> 181.0, 186.0, 195.0, None, 193.0, 190.0, 181.0, 195.0, 193.0, 190.0\n$ body_mass_g       <f64> 3750.0, 3800.0, 3250.0, None, 3450.0, 3650.0, 3625.0, 4675.0, 3475.0, 4250.0\n$ sex               <str> 'male', 'female', 'female', None, 'female', 'male', 'female', 'male', None, None\n$ year              <i64> 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007\n```\n:::\n:::\n\n\n:::\n\n\nOkay! What is cool for me so far about polars is that it is more getting used to the whole `.` thing. \n\n\n# Filter\n\nOne of the key things in data cleaning or working with data is working with observations that fit some criteria! In this case, lets just grab all the rows that have Adelie penguins and are above the mean body mass \n\n\n:::{.panel-tabset}\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\nfilter(species == \"Adelie\", body_mass_g > mean(body_mass_g, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 25 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Torgersen           39.2          19.6               195        4675\n 2 Adelie  Torgersen           42            20.2               190        4250\n 3 Adelie  Torgersen           34.6          21.1               198        4400\n 4 Adelie  Torgersen           42.5          20.7               197        4500\n 5 Adelie  Dream               39.8          19.1               184        4650\n 6 Adelie  Dream               44.1          19.7               196        4400\n 7 Adelie  Dream               39.6          18.8               190        4600\n 8 Adelie  Biscoe              40.1          18.9               188        4300\n 9 Adelie  Biscoe              41.3          21.1               195        4400\n10 Adelie  Torgersen           41.8          19.4               198        4450\n# ℹ 15 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n:::\n:::\n\n\n\n\n\n## Python \n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.filter(pl.col(\"species\") == \"Adelie\" &\n                pl.col(\"body_mass_g\" > mean(pl.col(\"body_mass_g\"))))\n```\n\n::: {.cell-output .cell-output-error}\n```\nname 'mean' is not defined\n```\n:::\n:::\n\n\n:::\n\nThis is my first attempt at it! It looks like the problem  I am running into is that Python does not have a `base python` where a function like mean is defined. \n\nAfter fiddling with it for some time it turns out the filter call is actually not correctly defined either! So before each filter option, you need to add a set of `()`\n\n:::{.panel-tabset}\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\nfilter(species == \"Adelie\", body_mass_g > mean(body_mass_g, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 25 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Torgersen           39.2          19.6               195        4675\n 2 Adelie  Torgersen           42            20.2               190        4250\n 3 Adelie  Torgersen           34.6          21.1               198        4400\n 4 Adelie  Torgersen           42.5          20.7               197        4500\n 5 Adelie  Dream               39.8          19.1               184        4650\n 6 Adelie  Dream               44.1          19.7               196        4400\n 7 Adelie  Dream               39.6          18.8               190        4600\n 8 Adelie  Biscoe              40.1          18.9               188        4300\n 9 Adelie  Biscoe              41.3          21.1               195        4400\n10 Adelie  Torgersen           41.8          19.4               198        4450\n# ℹ 15 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n:::\n:::\n\n\n\n\n\n## Python \n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.filter((pl.col(\"species\") == \"Adelie\") &\n                (pl.col(\"body_mass_g\") > pl.col(\"body_mass_g\").mean()))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (25, 8)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>species</th><th>island</th><th>bill_length_mm</th><th>bill_depth_mm</th><th>flipper_length_mm</th><th>body_mass_g</th><th>sex</th><th>year</th></tr><tr><td>str</td><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>str</td><td>i64</td></tr></thead><tbody><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td><td>39.2</td><td>19.6</td><td>195.0</td><td>4675.0</td><td>&quot;male&quot;</td><td>2007</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td><td>42.0</td><td>20.2</td><td>190.0</td><td>4250.0</td><td>null</td><td>2007</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td><td>34.6</td><td>21.1</td><td>198.0</td><td>4400.0</td><td>&quot;male&quot;</td><td>2007</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td><td>42.5</td><td>20.7</td><td>197.0</td><td>4500.0</td><td>&quot;male&quot;</td><td>2007</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Dream&quot;</td><td>39.8</td><td>19.1</td><td>184.0</td><td>4650.0</td><td>&quot;male&quot;</td><td>2007</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Biscoe&quot;</td><td>42.2</td><td>19.5</td><td>197.0</td><td>4275.0</td><td>&quot;male&quot;</td><td>2009</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td><td>41.5</td><td>18.3</td><td>195.0</td><td>4300.0</td><td>&quot;male&quot;</td><td>2009</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Dream&quot;</td><td>37.5</td><td>18.5</td><td>199.0</td><td>4475.0</td><td>&quot;male&quot;</td><td>2009</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Dream&quot;</td><td>39.7</td><td>17.9</td><td>193.0</td><td>4250.0</td><td>&quot;male&quot;</td><td>2009</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Dream&quot;</td><td>39.2</td><td>18.6</td><td>190.0</td><td>4250.0</td><td>&quot;male&quot;</td><td>2009</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n:::\n\nNobody said this was going to be pretty or seamless! One other thing to get used to is that we are not going to be using something crazy like `%in%` for set membership! We use `is_in` \n\n\n:::{.panel-tabset}\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\nfilter(species %in% c(\"Gentoo\", \"Chinstrap\"),\n       bill_depth_mm > median(bill_depth_mm, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 52 × 8\n   species   island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>     <fct>           <dbl>         <dbl>             <int>       <int>\n 1 Chinstrap Dream            46.5          17.9               192        3500\n 2 Chinstrap Dream            50            19.5               196        3900\n 3 Chinstrap Dream            51.3          19.2               193        3650\n 4 Chinstrap Dream            45.4          18.7               188        3525\n 5 Chinstrap Dream            52.7          19.8               197        3725\n 6 Chinstrap Dream            45.2          17.8               198        3950\n 7 Chinstrap Dream            46.1          18.2               178        3250\n 8 Chinstrap Dream            51.3          18.2               197        3750\n 9 Chinstrap Dream            46            18.9               195        4150\n10 Chinstrap Dream            51.3          19.9               198        3700\n# ℹ 42 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n:::\n:::\n\n\n\n\n\n## Python \n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.filter((pl.col(\"species\").is_in([\"Chinstrap\", \"Gentoo\"])) & \n                (pl.col(\"bill_depth_mm\") > pl.col(\"bill_depth_mm\").median()))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (52, 8)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>species</th><th>island</th><th>bill_length_mm</th><th>bill_depth_mm</th><th>flipper_length_mm</th><th>body_mass_g</th><th>sex</th><th>year</th></tr><tr><td>str</td><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>str</td><td>i64</td></tr></thead><tbody><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td><td>46.5</td><td>17.9</td><td>192.0</td><td>3500.0</td><td>&quot;female&quot;</td><td>2007</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td><td>50.0</td><td>19.5</td><td>196.0</td><td>3900.0</td><td>&quot;male&quot;</td><td>2007</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td><td>51.3</td><td>19.2</td><td>193.0</td><td>3650.0</td><td>&quot;male&quot;</td><td>2007</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td><td>45.4</td><td>18.7</td><td>188.0</td><td>3525.0</td><td>&quot;female&quot;</td><td>2007</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td><td>52.7</td><td>19.8</td><td>197.0</td><td>3725.0</td><td>&quot;male&quot;</td><td>2007</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td><td>55.8</td><td>19.8</td><td>207.0</td><td>4000.0</td><td>&quot;male&quot;</td><td>2009</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td><td>43.5</td><td>18.1</td><td>202.0</td><td>3400.0</td><td>&quot;female&quot;</td><td>2009</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td><td>49.6</td><td>18.2</td><td>193.0</td><td>3775.0</td><td>&quot;male&quot;</td><td>2009</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td><td>50.8</td><td>19.0</td><td>210.0</td><td>4100.0</td><td>&quot;male&quot;</td><td>2009</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td><td>50.2</td><td>18.7</td><td>198.0</td><td>3775.0</td><td>&quot;female&quot;</td><td>2009</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n:::\n\n\nOne other thing that is weird (to me at least) is that you do not have to set the polars functions to remove NA's by default! Which I suppose is nice? But feels a bit wrong and weird to me as an R user. \n\n\n\n# Select \n\n\nIn some cases, we have a dataset with extraneous columns we do not care for. Let's do a really extreme example \n\n\n\n:::{.panel-tabset}\n\n## R \n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\nselect(island)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 × 1\n   island   \n   <fct>    \n 1 Torgersen\n 2 Torgersen\n 3 Torgersen\n 4 Torgersen\n 5 Torgersen\n 6 Torgersen\n 7 Torgersen\n 8 Torgersen\n 9 Torgersen\n10 Torgersen\n# ℹ 334 more rows\n```\n:::\n:::\n\n\n## Python\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.select((pl.col(\"island\")))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (344, 1)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>island</th></tr><tr><td>str</td></tr></thead><tbody><tr><td>&quot;Torgersen&quot;</td></tr><tr><td>&quot;Torgersen&quot;</td></tr><tr><td>&quot;Torgersen&quot;</td></tr><tr><td>&quot;Torgersen&quot;</td></tr><tr><td>&quot;Torgersen&quot;</td></tr><tr><td>&hellip;</td></tr><tr><td>&quot;Dream&quot;</td></tr><tr><td>&quot;Dream&quot;</td></tr><tr><td>&quot;Dream&quot;</td></tr><tr><td>&quot;Dream&quot;</td></tr><tr><td>&quot;Dream&quot;</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n\n:::\n\n\nOKAY! first try now we are cooking! If we wanted to do multiple columns we would do something to the effect of\n\n\n:::{.panel-tabset}\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\nselect(species, island)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 × 2\n   species island   \n   <fct>   <fct>    \n 1 Adelie  Torgersen\n 2 Adelie  Torgersen\n 3 Adelie  Torgersen\n 4 Adelie  Torgersen\n 5 Adelie  Torgersen\n 6 Adelie  Torgersen\n 7 Adelie  Torgersen\n 8 Adelie  Torgersen\n 9 Adelie  Torgersen\n10 Adelie  Torgersen\n# ℹ 334 more rows\n```\n:::\n:::\n\n\n\n\n\n## Python \n\nTo do multiple columns we could do something to the effect of this:\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.select((pl.col(\"species\", \"island\")))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (344, 2)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>species</th><th>island</th></tr><tr><td>str</td><td>str</td></tr></thead><tbody><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td></tr><tr><td>&hellip;</td><td>&hellip;</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n:::\n\nWhich feels more natural to me, but to some extent a dictionary would probably be more pythony.\n\n\nOne thing I use all the time is using tidyselectors like `starts_with` \n\n\n:::{.panel-tabset}\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\nselect(starts_with(\"bill\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 × 2\n   bill_length_mm bill_depth_mm\n            <dbl>         <dbl>\n 1           39.1          18.7\n 2           39.5          17.4\n 3           40.3          18  \n 4           NA            NA  \n 5           36.7          19.3\n 6           39.3          20.6\n 7           38.9          17.8\n 8           39.2          19.6\n 9           34.1          18.1\n10           42            20.2\n# ℹ 334 more rows\n```\n:::\n:::\n\n\n\n\n\n## Python \n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.select(cs.starts_with(\"bill\"))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (344, 2)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>bill_length_mm</th><th>bill_depth_mm</th></tr><tr><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>39.1</td><td>18.7</td></tr><tr><td>39.5</td><td>17.4</td></tr><tr><td>40.3</td><td>18.0</td></tr><tr><td>null</td><td>null</td></tr><tr><td>36.7</td><td>19.3</td></tr><tr><td>&hellip;</td><td>&hellip;</td></tr><tr><td>55.8</td><td>19.8</td></tr><tr><td>43.5</td><td>18.1</td></tr><tr><td>49.6</td><td>18.2</td></tr><tr><td>50.8</td><td>19.0</td></tr><tr><td>50.2</td><td>18.7</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n:::\n\nThis is actually so cool that in this case it works exactly like the tidyverse selector functions! \n\n\n\n# Mutate \n\nOkay we have worked with subsets now we need to actually create some things. We should also work on chaining things together. Lets first with doing math stuff to the columns. Lets start with how I think it works in polars and if it errors then we can go and fix it\n\n\n\n:::{.panel-tabset}\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\nmutate(sqr_bill_length = bill_length_mm^2) |>\nselect(sqr_bill_length) |>\nhead()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 1\n  sqr_bill_length\n            <dbl>\n1           1529.\n2           1560.\n3           1624.\n4             NA \n5           1347.\n6           1544.\n```\n:::\n:::\n\n\n\n\n\n## Python \n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.mutate({pl.col(\"bill_length_mm\")^2: \"sqr_bill_length\"}).select(pl.col(\"sqr_bill_length\"))\n```\n\n::: {.cell-output .cell-output-error}\n```\n'DataFrame' object has no attribute 'mutate'\n```\n:::\n:::\n\n\n:::\n\n\nOkay where I am coming from is that in my head what we are doing is using the same logic as renaming columns. Lets fix it. So the first problem is that there is no `mutate` verb. Instead we use `with_column` \n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.with_columns(sqr_bill_length = pl.col(\"bill_length_mm\")**2).select(pl.col(\"sqr_bill_length\")).head()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 1)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>sqr_bill_length</th></tr><tr><td>f64</td></tr></thead><tbody><tr><td>1528.81</td></tr><tr><td>1560.25</td></tr><tr><td>1624.09</td></tr><tr><td>null</td></tr><tr><td>1346.89</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n\nOkay this is the general idea. One of the big advantages of mutate is that we chain things together in the same mutate col. So lets say we wanted to square something than return it back to the original value\n\n\n:::{.panel-tabset}\n\n\n## R \n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\nmutate(sqr_bill = bill_length_mm^2,\n       og_bill = sqrt(sqr_bill)) |>\n       select(sqr_bill, og_bill, bill_length_mm) |>\n       head(n = 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 3\n  sqr_bill og_bill bill_length_mm\n     <dbl>   <dbl>          <dbl>\n1    1529.    39.1           39.1\n2    1560.    39.5           39.5\n3    1624.    40.3           40.3\n4      NA     NA             NA  \n5    1347.    36.7           36.7\n```\n:::\n:::\n\n\n\n\n## Python \n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.with_columns(sqr_bill = pl.col(\"bill_length_mm\")**2).with_columns(og_bill = pl.col(\"sqr_bill\").sqrt()).select(pl.col(\"sqr_bill\", \"og_bill\", \"bill_length_mm\")).head(5)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 3)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>sqr_bill</th><th>og_bill</th><th>bill_length_mm</th></tr><tr><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>1528.81</td><td>39.1</td><td>39.1</td></tr><tr><td>1560.25</td><td>39.5</td><td>39.5</td></tr><tr><td>1624.09</td><td>40.3</td><td>40.3</td></tr><tr><td>null</td><td>null</td><td>null</td></tr><tr><td>1346.89</td><td>36.7</td><td>36.7</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n\n:::\n\n\nNow the next step is creating conditionals \n\n\n\n:::{.panel-tabset}\n\n\n## R \n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\nmutate(female = ifelse(sex == \"female\", TRUE, FALSE)) |>\nselect(sex, female) |>\nhead(5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 2\n  sex    female\n  <fct>  <lgl> \n1 male   FALSE \n2 female TRUE  \n3 female TRUE  \n4 <NA>   NA    \n5 female TRUE  \n```\n:::\n:::\n\n\n\n\n## Python \n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.with_columns(female = pl.when(pl.col(\"sex\") == \"female\").then(True).otherwise(False)).select([\"sex\", \"female\"]).head(5)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 2)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>sex</th><th>female</th></tr><tr><td>str</td><td>bool</td></tr></thead><tbody><tr><td>&quot;male&quot;</td><td>false</td></tr><tr><td>&quot;female&quot;</td><td>true</td></tr><tr><td>&quot;female&quot;</td><td>true</td></tr><tr><td>null</td><td>false</td></tr><tr><td>&quot;female&quot;</td><td>true</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n\n:::\n\nFull disclosure this took a much longer time than shown but this is the basic idea. Lets do this to keep myself a bit more honest. Recreate a silly example that I use to teach ifelse using the starwars dataset. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"starwars\")\n\nwrite_csv(starwars, \"starwars.csv\")\n```\n:::\n\n\n\n:::{.panel-tabset}\n\n\n## R \n\n\n::: {.cell}\n\n```{.r .cell-code}\nstarwars |>\nmutate(dog_years = birth_year * 7,\n       comment = paste(name, \"is\", dog_years, \"in dog years\")) |>\n       select(name, dog_years, comment) |>\n       head(5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 3\n  name           dog_years comment                           \n  <chr>              <dbl> <chr>                             \n1 Luke Skywalker      133  Luke Skywalker is 133 in dog years\n2 C-3PO               784  C-3PO is 784 in dog years         \n3 R2-D2               231  R2-D2 is 231 in dog years         \n4 Darth Vader         293. Darth Vader is 293.3 in dog years \n5 Leia Organa         133  Leia Organa is 133 in dog years   \n```\n:::\n:::\n\n\n\n\n## Python \n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nstarwars = pl.read_csv(\"starwars.csv\")\n\nstarwars.with_columns(dog_years = pl.col(\"birth_year\") * 7).with_columns(dog_years_string = pl.col(\"dog_years\").cast(str)).with_columns(comment = pl.col(\"name\") + \" is \" + pl.col(\"dog_years_string\") + \" in dog years \")\n```\n\n::: {.cell-output .cell-output-error}\n```\narithmetic on string and numeric not allowed, try an explicit cast first\n```\n:::\n:::\n\n\n\n:::\n\nIt turns out that the column was actually a string \n\n\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nstarwars.glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 87\nColumns: 14\n$ name       <str> 'Luke Skywalker', 'C-3PO', 'R2-D2', 'Darth Vader', 'Leia Organa', 'Owen Lars', 'Beru Whitesun lars', 'R5-D4', 'Biggs Darklighter', 'Obi-Wan Kenobi'\n$ height     <str> '172', '167', '96', '202', '150', '178', '165', '97', '183', '182'\n$ mass       <str> '77', '75', '32', '136', '49', '120', '75', '32', '84', '77'\n$ hair_color <str> 'blond', 'NA', 'NA', 'none', 'brown', 'brown, grey', 'brown', 'NA', 'black', 'auburn, white'\n$ skin_color <str> 'fair', 'gold', 'white, blue', 'white', 'light', 'light', 'light', 'white, red', 'light', 'fair'\n$ eye_color  <str> 'blue', 'yellow', 'red', 'yellow', 'brown', 'blue', 'blue', 'red', 'brown', 'blue-gray'\n$ birth_year <str> '19', '112', '33', '41.9', '19', '52', '47', 'NA', '24', '57'\n$ sex        <str> 'male', 'none', 'none', 'male', 'female', 'male', 'female', 'none', 'male', 'male'\n$ gender     <str> 'masculine', 'masculine', 'masculine', 'masculine', 'feminine', 'masculine', 'feminine', 'masculine', 'masculine', 'masculine'\n$ homeworld  <str> 'Tatooine', 'Tatooine', 'Naboo', 'Tatooine', 'Alderaan', 'Tatooine', 'Tatooine', 'Tatooine', 'Tatooine', 'Stewjon'\n$ species    <str> 'Human', 'Droid', 'Droid', 'Human', 'Human', 'Human', 'Human', 'Droid', 'Human', 'Human'\n$ films      <str> None, None, None, None, None, None, None, None, None, None\n$ vehicles   <str> None, None, None, None, None, None, None, None, None, None\n$ starships  <str> None, None, None, None, None, None, None, None, None, None\n```\n:::\n\n```{.python .cell-code}\nstarwars.with_columns(dog_years = pl.col(\"birth_year\").str.to_integer(strict = False)*7).with_columns(dog_years_string = pl.col(\"dog_years\").cast(pl.String)).with_columns(comment = pl.col(\"name\") + \" is \" + pl.col(\"dog_years_string\")  + \" in dog years\").select(pl.col(\"name\", \"dog_years\", \"comment\"))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (87, 3)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>name</th><th>dog_years</th><th>comment</th></tr><tr><td>str</td><td>i64</td><td>str</td></tr></thead><tbody><tr><td>&quot;Luke Skywalker…</td><td>133</td><td>&quot;Luke Skywalker…</td></tr><tr><td>&quot;C-3PO&quot;</td><td>784</td><td>&quot;C-3PO is 784 i…</td></tr><tr><td>&quot;R2-D2&quot;</td><td>231</td><td>&quot;R2-D2 is 231 i…</td></tr><tr><td>&quot;Darth Vader&quot;</td><td>null</td><td>null</td></tr><tr><td>&quot;Leia Organa&quot;</td><td>133</td><td>&quot;Leia Organa is…</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>&quot;Rey&quot;</td><td>null</td><td>null</td></tr><tr><td>&quot;Poe Dameron&quot;</td><td>null</td><td>null</td></tr><tr><td>&quot;BB8&quot;</td><td>null</td><td>null</td></tr><tr><td>&quot;Captain Phasma…</td><td>null</td><td>null</td></tr><tr><td>&quot;Padmé Amidala&quot;</td><td>322</td><td>&quot;Padmé Amidala …</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n\n\nLets also do this for penguins but make it fun \n\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.with_columns(big_peng = pl.when(pl.col(\"body_mass_g\") > pl.col(\"body_mass_g\").mean()).then(True).otherwise(False))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (344, 9)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>species</th><th>island</th><th>bill_length_mm</th><th>bill_depth_mm</th><th>flipper_length_mm</th><th>body_mass_g</th><th>sex</th><th>year</th><th>big_peng</th></tr><tr><td>str</td><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>str</td><td>i64</td><td>bool</td></tr></thead><tbody><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td><td>39.1</td><td>18.7</td><td>181.0</td><td>3750.0</td><td>&quot;male&quot;</td><td>2007</td><td>false</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td><td>39.5</td><td>17.4</td><td>186.0</td><td>3800.0</td><td>&quot;female&quot;</td><td>2007</td><td>false</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td><td>40.3</td><td>18.0</td><td>195.0</td><td>3250.0</td><td>&quot;female&quot;</td><td>2007</td><td>false</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td><td>null</td><td>null</td><td>null</td><td>null</td><td>null</td><td>2007</td><td>false</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td><td>36.7</td><td>19.3</td><td>193.0</td><td>3450.0</td><td>&quot;female&quot;</td><td>2007</td><td>false</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td><td>55.8</td><td>19.8</td><td>207.0</td><td>4000.0</td><td>&quot;male&quot;</td><td>2009</td><td>false</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td><td>43.5</td><td>18.1</td><td>202.0</td><td>3400.0</td><td>&quot;female&quot;</td><td>2009</td><td>false</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td><td>49.6</td><td>18.2</td><td>193.0</td><td>3775.0</td><td>&quot;male&quot;</td><td>2009</td><td>false</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td><td>50.8</td><td>19.0</td><td>210.0</td><td>4100.0</td><td>&quot;male&quot;</td><td>2009</td><td>false</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td><td>50.2</td><td>18.7</td><td>198.0</td><td>3775.0</td><td>&quot;female&quot;</td><td>2009</td><td>false</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n\n\n\n\n## Group by and summarize\n\n\nLast but not least we need to do the group by and summarise bit. It looks like this is slightly more intuitive\n\n\n:::{.panel-tabset}\n\n\n## R \n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\ngroup_by(species) |>\nsummarise(total = n())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 2\n  species   total\n  <fct>     <int>\n1 Adelie      152\n2 Chinstrap    68\n3 Gentoo      124\n```\n:::\n:::\n\n\n\n\n## Python \n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.group_by(pl.col(\"species\")).agg(total = pl.count())\n```\n\n::: {.cell-output-display}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (3, 2)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>species</th><th>total</th></tr><tr><td>str</td><td>u32</td></tr></thead><tbody><tr><td>&quot;Chinstrap&quot;</td><td>68</td></tr><tr><td>&quot;Gentoo&quot;</td><td>124</td></tr><tr><td>&quot;Adelie&quot;</td><td>152</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n\n:::\n\n\nLets do some mathy stuff \n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.group_by(pl.col(\"species\")).agg(count = pl.len(),\n                                         mean_flipp = pl.mean(\"flipper_length_mm\"),\n                                         median_flipp = pl.median(\"flipper_length_mm\"))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (3, 4)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>species</th><th>count</th><th>mean_flipp</th><th>median_flipp</th></tr><tr><td>str</td><td>u32</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;Gentoo&quot;</td><td>124</td><td>217.186992</td><td>216.0</td></tr><tr><td>&quot;Adelie&quot;</td><td>152</td><td>189.953642</td><td>190.0</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>68</td><td>195.823529</td><td>196.0</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n\nA thing that is useful in summarize is that we can use our selectors to summarise across multiple columns like this \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\ngroup_by(species) |>\nsummarise(across(starts_with(\"bill\"), list(mean = \\(x) mean(x, na.rm = TRUE,\n                                           median = \\(x) median(x, na.rm,  TRUE)))))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 3\n  species   bill_length_mm_mean bill_depth_mm_mean\n  <fct>                   <dbl>              <dbl>\n1 Adelie                   38.8               18.3\n2 Chinstrap                48.8               18.4\n3 Gentoo                   47.5               15.0\n```\n:::\n:::\n\n\n\n\nIn polars I imagine it would probably be something like this \n\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.group_by(pl.col(\"species\")).agg(cs.starts_with(\"bill\").mean())\n```\n\n::: {.cell-output-display}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (3, 3)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>species</th><th>bill_length_mm</th><th>bill_depth_mm</th></tr><tr><td>str</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;Chinstrap&quot;</td><td>48.833824</td><td>18.420588</td></tr><tr><td>&quot;Gentoo&quot;</td><td>47.504878</td><td>14.982114</td></tr><tr><td>&quot;Adelie&quot;</td><td>38.791391</td><td>18.346358</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n\nThe think I am running into now is that I would like to add a `_` without doing any extra work. It looks like according to the docs it should be this \n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.group_by(pl.col(\"species\")).agg(cs.starts_with(\"bill\").mean().name.suffix(\"_mean\"),\n                                         cs.starts_with(\"bill\").median().name.suffix(\"_median\"))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (3, 5)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>species</th><th>bill_length_mm_mean</th><th>bill_depth_mm_mean</th><th>bill_length_mm_median</th><th>bill_depth_mm_median</th></tr><tr><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td></tr></thead><tbody><tr><td>&quot;Gentoo&quot;</td><td>47.504878</td><td>14.982114</td><td>47.3</td><td>15.0</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>48.833824</td><td>18.420588</td><td>49.55</td><td>18.45</td></tr><tr><td>&quot;Adelie&quot;</td><td>38.791391</td><td>18.346358</td><td>38.8</td><td>18.4</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n\n# Misc stuff that are usefull but not neccessarilly useful all the time \n\nHere are the collection of misfits that I thought would be useful \n\n\n### Slice(family)\n\nOne useful thing that I use all the time when testing out various things I am doing is using slice. This can be specific rows or a random sample of rows! \n\n\nIf we wanted specific rows we could do this with `slice` \n\n:::{.panel-tabset}\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\nslice(90:100)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 11 × 8\n   species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>           <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Dream            38.9          18.8               190        3600\n 2 Adelie  Dream            35.7          18                 202        3550\n 3 Adelie  Dream            41.1          18.1               205        4300\n 4 Adelie  Dream            34            17.1               185        3400\n 5 Adelie  Dream            39.6          18.1               186        4450\n 6 Adelie  Dream            36.2          17.3               187        3300\n 7 Adelie  Dream            40.8          18.9               208        4300\n 8 Adelie  Dream            38.1          18.6               190        3700\n 9 Adelie  Dream            40.3          18.5               196        4350\n10 Adelie  Dream            33.1          16.1               178        2900\n11 Adelie  Dream            43.2          18.5               192        4100\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n:::\n:::\n\n\n\n\n\n## Python \n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.slice(89:10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ninvalid syntax (<string>, line 1)\n```\n:::\n:::\n\n\n:::\n\n\nIt looks like the R user in me strikes. So in polars if you wanted to do the same thing you give the starting number of the row you want and the length of the row you want. So we would rewrite the code like this \n\n\n\n\n:::{.panel-tabset}\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\nslice(90:100)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 11 × 8\n   species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>           <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Dream            38.9          18.8               190        3600\n 2 Adelie  Dream            35.7          18                 202        3550\n 3 Adelie  Dream            41.1          18.1               205        4300\n 4 Adelie  Dream            34            17.1               185        3400\n 5 Adelie  Dream            39.6          18.1               186        4450\n 6 Adelie  Dream            36.2          17.3               187        3300\n 7 Adelie  Dream            40.8          18.9               208        4300\n 8 Adelie  Dream            38.1          18.6               190        3700\n 9 Adelie  Dream            40.3          18.5               196        4350\n10 Adelie  Dream            33.1          16.1               178        2900\n11 Adelie  Dream            43.2          18.5               192        4100\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n:::\n:::\n\n\n\n\n\n## Python \n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.slice(89,10)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (10, 8)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>species</th><th>island</th><th>bill_length_mm</th><th>bill_depth_mm</th><th>flipper_length_mm</th><th>body_mass_g</th><th>sex</th><th>year</th></tr><tr><td>str</td><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>str</td><td>i64</td></tr></thead><tbody><tr><td>&quot;Adelie&quot;</td><td>&quot;Dream&quot;</td><td>38.9</td><td>18.8</td><td>190.0</td><td>3600.0</td><td>&quot;female&quot;</td><td>2008</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Dream&quot;</td><td>35.7</td><td>18.0</td><td>202.0</td><td>3550.0</td><td>&quot;female&quot;</td><td>2008</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Dream&quot;</td><td>41.1</td><td>18.1</td><td>205.0</td><td>4300.0</td><td>&quot;male&quot;</td><td>2008</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Dream&quot;</td><td>34.0</td><td>17.1</td><td>185.0</td><td>3400.0</td><td>&quot;female&quot;</td><td>2008</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Dream&quot;</td><td>39.6</td><td>18.1</td><td>186.0</td><td>4450.0</td><td>&quot;male&quot;</td><td>2008</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Dream&quot;</td><td>36.2</td><td>17.3</td><td>187.0</td><td>3300.0</td><td>&quot;female&quot;</td><td>2008</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Dream&quot;</td><td>40.8</td><td>18.9</td><td>208.0</td><td>4300.0</td><td>&quot;male&quot;</td><td>2008</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Dream&quot;</td><td>38.1</td><td>18.6</td><td>190.0</td><td>3700.0</td><td>&quot;female&quot;</td><td>2008</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Dream&quot;</td><td>40.3</td><td>18.5</td><td>196.0</td><td>4350.0</td><td>&quot;male&quot;</td><td>2008</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Dream&quot;</td><td>33.1</td><td>16.1</td><td>178.0</td><td>2900.0</td><td>&quot;female&quot;</td><td>2008</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n:::\n\nI actually quite like the syntax of the python version better. It is just annoying having to reset my thinking to start counting at `0`\n\n\n\n\n### Slice Sample \n\nI find it useful to take a random sample of rows and test functions. It is nice for the function to work on a set of examples you come up with but not everything is consistent so lopping off chunks of a dataset and seeing if it still works is useful. \n\n\n\n:::{.panel-tabset}\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1994)\npenguins |>\nslice_sample(n = 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10 × 8\n   species   island   bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>     <fct>             <dbl>         <dbl>             <int>       <int>\n 1 Chinstrap Dream              50.2          18.7               198        3775\n 2 Adelie    Biscoe             39.7          18.9               184        3550\n 3 Chinstrap Dream              45.4          18.7               188        3525\n 4 Gentoo    Biscoe             46.2          14.1               217        4375\n 5 Gentoo    Biscoe             50            16.3               230        5700\n 6 Chinstrap Dream              49.8          17.3               198        3675\n 7 Adelie    Biscoe             35            17.9               192        3725\n 8 Adelie    Biscoe             40.6          18.6               183        3550\n 9 Adelie    Torgers…           40.6          19                 199        4000\n10 Chinstrap Dream              46.5          17.9               192        3500\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n:::\n:::\n\n\n\n\n\n## Python \n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins.sample(n = 10, seed = 1994)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (10, 8)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>species</th><th>island</th><th>bill_length_mm</th><th>bill_depth_mm</th><th>flipper_length_mm</th><th>body_mass_g</th><th>sex</th><th>year</th></tr><tr><td>str</td><td>str</td><td>f64</td><td>f64</td><td>f64</td><td>f64</td><td>str</td><td>i64</td></tr></thead><tbody><tr><td>&quot;Adelie&quot;</td><td>&quot;Biscoe&quot;</td><td>42.7</td><td>18.3</td><td>196.0</td><td>4075.0</td><td>&quot;male&quot;</td><td>2009</td></tr><tr><td>&quot;Gentoo&quot;</td><td>&quot;Biscoe&quot;</td><td>50.0</td><td>15.2</td><td>218.0</td><td>5700.0</td><td>&quot;male&quot;</td><td>2007</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Biscoe&quot;</td><td>35.0</td><td>17.9</td><td>192.0</td><td>3725.0</td><td>&quot;female&quot;</td><td>2009</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Torgersen&quot;</td><td>36.6</td><td>17.8</td><td>185.0</td><td>3700.0</td><td>&quot;female&quot;</td><td>2007</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Dream&quot;</td><td>36.0</td><td>18.5</td><td>186.0</td><td>3100.0</td><td>&quot;female&quot;</td><td>2007</td></tr><tr><td>&quot;Gentoo&quot;</td><td>&quot;Biscoe&quot;</td><td>48.4</td><td>14.4</td><td>203.0</td><td>4625.0</td><td>&quot;female&quot;</td><td>2009</td></tr><tr><td>&quot;Chinstrap&quot;</td><td>&quot;Dream&quot;</td><td>50.2</td><td>18.7</td><td>198.0</td><td>3775.0</td><td>&quot;female&quot;</td><td>2009</td></tr><tr><td>&quot;Gentoo&quot;</td><td>&quot;Biscoe&quot;</td><td>45.2</td><td>16.4</td><td>223.0</td><td>5950.0</td><td>&quot;male&quot;</td><td>2008</td></tr><tr><td>&quot;Gentoo&quot;</td><td>&quot;Biscoe&quot;</td><td>49.8</td><td>16.8</td><td>230.0</td><td>5700.0</td><td>&quot;male&quot;</td><td>2008</td></tr><tr><td>&quot;Adelie&quot;</td><td>&quot;Dream&quot;</td><td>38.8</td><td>20.0</td><td>190.0</td><td>3950.0</td><td>&quot;male&quot;</td><td>2007</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n:::\n\nLuckily the syntax is broadly the same! \n\n\n\n### Renaming \n\nI am a simple man I like snake_case but lets say I am more camel case inclined. I may want to rename columns that I am using as to not deal with object not found messages because I am used to typing billLengthMm. In the tidyverse we would do \n\n\n:::{.panel-tabset}\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\nrename(BillLengthMm = bill_length_mm,\n       BillDepthMm = bill_depth_mm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 × 8\n   species island   BillLengthMm BillDepthMm flipper_length_mm body_mass_g sex  \n   <fct>   <fct>           <dbl>       <dbl>             <int>       <int> <fct>\n 1 Adelie  Torgers…         39.1        18.7               181        3750 male \n 2 Adelie  Torgers…         39.5        17.4               186        3800 fema…\n 3 Adelie  Torgers…         40.3        18                 195        3250 fema…\n 4 Adelie  Torgers…         NA          NA                  NA          NA <NA> \n 5 Adelie  Torgers…         36.7        19.3               193        3450 fema…\n 6 Adelie  Torgers…         39.3        20.6               190        3650 male \n 7 Adelie  Torgers…         38.9        17.8               181        3625 fema…\n 8 Adelie  Torgers…         39.2        19.6               195        4675 male \n 9 Adelie  Torgers…         34.1        18.1               193        3475 <NA> \n10 Adelie  Torgers…         42          20.2               190        4250 <NA> \n# ℹ 334 more rows\n# ℹ 1 more variable: year <int>\n```\n:::\n:::\n\n\n\n\n\n## Python \n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\npenguins = penguins.rename({\"bill_length_mm\": \"BillLengthMm\",\n                \"bill_depth_mm\" : \"BillDepthMm\"})\n\n```\n:::\n\n\n:::\n\n\nIn effect the thing you need to switch in your head when working in polars is that the order goes `old_name`:`new_name` I assigned it to an object because I wanted to test out a module I found online.\n\n\n\n### Batch renaming \n\nOften times if we download data from the internet the column names are a mess and we want to rename them all at once. The janitor package in R is extra handy\n\nLets say we wanted to mass produce a camel case across the entire dataframe. In `R` that is a fairly simple task. Is it the case for python? \n\n\n\n:::{.panel-tabset}\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\njanitor::clean_names(case = \"lower_camel\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 × 8\n   species island billLengthMm billDepthMm flipperLengthMm bodyMassG sex    year\n   <fct>   <fct>         <dbl>       <dbl>           <int>     <int> <fct> <int>\n 1 Adelie  Torge…         39.1        18.7             181      3750 male   2007\n 2 Adelie  Torge…         39.5        17.4             186      3800 fema…  2007\n 3 Adelie  Torge…         40.3        18               195      3250 fema…  2007\n 4 Adelie  Torge…         NA          NA                NA        NA <NA>   2007\n 5 Adelie  Torge…         36.7        19.3             193      3450 fema…  2007\n 6 Adelie  Torge…         39.3        20.6             190      3650 male   2007\n 7 Adelie  Torge…         38.9        17.8             181      3625 fema…  2007\n 8 Adelie  Torge…         39.2        19.6             195      4675 male   2007\n 9 Adelie  Torge…         34.1        18.1             193      3475 <NA>   2007\n10 Adelie  Torge…         42          20.2             190      4250 <NA>   2007\n# ℹ 334 more rows\n```\n:::\n:::\n\n\n\n\n\n## Python \n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nfrom janitor import clean_names\n\npenguins.clean_names()\n```\n\n::: {.cell-output .cell-output-error}\n```\n'DataFrame' object has no attribute 'clean_names'\n```\n:::\n:::\n\n\n:::\n\n\nIn my head it looks like this. Where we are effectively chaining clean names to the dataframe. From the documentation it looks like this \n\n\n\n:::{.panel-tabset}\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\njanitor::clean_names(case = \"small_camel\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 × 8\n   species island billLengthMm billDepthMm flipperLengthMm bodyMassG sex    year\n   <fct>   <fct>         <dbl>       <dbl>           <int>     <int> <fct> <int>\n 1 Adelie  Torge…         39.1        18.7             181      3750 male   2007\n 2 Adelie  Torge…         39.5        17.4             186      3800 fema…  2007\n 3 Adelie  Torge…         40.3        18               195      3250 fema…  2007\n 4 Adelie  Torge…         NA          NA                NA        NA <NA>   2007\n 5 Adelie  Torge…         36.7        19.3             193      3450 fema…  2007\n 6 Adelie  Torge…         39.3        20.6             190      3650 male   2007\n 7 Adelie  Torge…         38.9        17.8             181      3625 fema…  2007\n 8 Adelie  Torge…         39.2        19.6             195      4675 male   2007\n 9 Adelie  Torge…         34.1        18.1             193      3475 <NA>   2007\n10 Adelie  Torge…         42          20.2             190      4250 <NA>   2007\n# ℹ 334 more rows\n```\n:::\n:::\n\n\n\n\n\n## Python \n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nclean_names(penguins)\n```\n\n::: {.cell-output .cell-output-error}\n```\n'list' object has no attribute 'dtype'\n```\n:::\n:::\n\n\n:::\n\n\nOkay the trick it looks like is that it does not work with polars objects. So we need to pass it to pandas and then back to polars. \n\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport pandas as pd \n\npenguins.glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 344\nColumns: 8\n$ species           <str> 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie'\n$ island            <str> 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen'\n$ BillLengthMm      <f64> 39.1, 39.5, 40.3, None, 36.7, 39.3, 38.9, 39.2, 34.1, 42.0\n$ BillDepthMm       <f64> 18.7, 17.4, 18.0, None, 19.3, 20.6, 17.8, 19.6, 18.1, 20.2\n$ flipper_length_mm <f64> 181.0, 186.0, 195.0, None, 193.0, 190.0, 181.0, 195.0, 193.0, 190.0\n$ body_mass_g       <f64> 3750.0, 3800.0, 3250.0, None, 3450.0, 3650.0, 3625.0, 4675.0, 3475.0, 4250.0\n$ sex               <str> 'male', 'female', 'female', None, 'female', 'male', 'female', 'male', None, None\n$ year              <i64> 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007\n```\n:::\n\n```{.python .cell-code}\npenguins_pd = penguins.to_pandas()\n\npenguins_clean = clean_names(penguins_pd, case_type = \"snake\")\n\npenguins = pl.from_pandas(penguins_clean)\n\npenguins.glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 344\nColumns: 8\n$ species           <str> 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie', 'Adelie'\n$ island            <str> 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen', 'Torgersen'\n$ bill_length_mm    <f64> 39.1, 39.5, 40.3, None, 36.7, 39.3, 38.9, 39.2, 34.1, 42.0\n$ bill_depth_mm     <f64> 18.7, 17.4, 18.0, None, 19.3, 20.6, 17.8, 19.6, 18.1, 20.2\n$ flipper_length_mm <f64> 181.0, 186.0, 195.0, None, 193.0, 190.0, 181.0, 195.0, 193.0, 190.0\n$ body_mass_g       <f64> 3750.0, 3800.0, 3250.0, None, 3450.0, 3650.0, 3625.0, 4675.0, 3475.0, 4250.0\n$ sex               <str> 'male', 'female', 'female', None, 'female', 'male', 'female', 'male', None, None\n$ year              <i64> 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007\n```\n:::\n:::\n\n\n\nThis works which is awesome! We got back to the original dataset naes \n\n\n\n## Make a column into a vector\n\n\nIn R there are like a ton of different ways to do this \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvec1 = penguins$bill_depth_mm\n\nvec2 = penguins |>\npluck(\"bill_depth_mm\")\n\nvec3 = penguins |>\nselect(bill_depth_mm) |>\ndeframe()\n```\n:::\n\n\nIn polars the equivalent of this \n\n\n::: {.cell}\n\n```{.python .cell-code}\nvec1 = penguins[\"bill_depth_mm\"]\n\nprint(vec1[0,1])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nshape: (2,)\nSeries: 'bill_depth_mm' [f64]\n[\n\t18.7\n\t17.4\n]\n```\n:::\n:::\n\n\n\n:::{.panel-tabset}\n\n## R\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvec1[1:3]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 18.7 17.4 18.0\n```\n:::\n:::\n\n\n\n\n\n## Python \n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport numpy as np \n\nprint(vec1[0:2])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nshape: (2,)\nSeries: 'bill_depth_mm' [f64]\n[\n\t18.7\n\t17.4\n]\n```\n:::\n:::\n\n\n:::\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}